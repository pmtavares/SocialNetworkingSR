
@{
    ViewBag.Title = ViewBag.Username;
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="row">
    <div class="col-xs-12 col-md-6">
        <p class="userimg">
            <img src="~/Uploads/@ViewBag.UsernameImage" />
        </p>
        <h3>@ViewBag.ViewFullName (@ViewBag.Username)</h3>

    </div>


</div>



@section Scripts{

<script src="~/Scripts/jquery.signalR-2.1.2.min.js"></script>
<script src="/signalr/hubs"></script>

    
<script>
    $(function () {

        //Live search
        $("#searchtext").keyup(function () {
 
            var searchVal = $("#searchtext").val();

            $("#livesearch").empty();


            if (searchVal == "" || searchVal == " ") {
                return false;
            }
            var url = "profile/LiveSearch";

            $.post(url, { search:  searchVal }, function (data) {
                if (data.length > 0) {
                    $("#livesearch").append("<li class=closeSearch>X</li>");
                }
                for (var i = 0; i < data.length; i++) {
                    var obj = data[i];
                    $("#livesearch")
                        .append("<li class='livesearchli'><a href='/" + obj.Username + "'><img src='/Uploads/" + obj.UserId + ".jpg' class=searchImg />" + " " + " " + obj.FirstName + " " + obj.LastName + "</a></li>");
                        
                }
            });
        })

    });


    $("body").on("click", ".closeSearch", function () {
        $("#livesearch").empty();
        $("#searchtext").val("");
    });

    /*
    *   Hub
    *
    */
    //Setup connection
    var hub = $.connection.echo;

    //client function to be called from server
    hub.client.test = function (msg) {
        console.log(msg);
    }

    //Connect to hub
    $.connection.hub
        .start()
        .done(function () {
            hub.server.hello("SignalR working");

    })


</script>    
    
}